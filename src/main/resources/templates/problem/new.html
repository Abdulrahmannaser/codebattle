<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css">
    <link rel="stylesheet" type="text/css" th:href="@{../../css/bootstrap.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{../../css/flag-icon.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{../../css/main.css}">
    <link rel="stylesheet" type="text/css" th:href="@{../../css/profileSummaryCard.css}">
    <link rel="stylesheet" type="text/css" th:href="@{../../css/secondaryNav.css}">
    <title>CodeBattle | Problem Creator</title>
</head>

<body>

<header th:replace="fragments/header :: header('problems')">...</header>

<div class="container">

    <div class="row">
        <div class="col-md-8 col-xs-8">
            <form th:action="@{/problems/new/}" th:object="${problem}" enctype="multipart/form-data" th:method="POST">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" class="form-control" placeholder="Problem name" th:field="*{name}">
                </div>
                <ul class="text-danger" th:if="${#fields.hasErrors('name')}" >
                    <li  th:each="err: ${#fields.errors('name')}" th:text="${err}"></li>
                </ul>
                <div class="form-group">
                    <label>Description</label>
                    <textarea class="form-control" placeholder="Description" rows="10" th:field="*{description}"></textarea>
                </div>
                <ul class="text-danger" th:if="${#fields.hasErrors('description')}" >
                    <li  th:each="err: ${#fields.errors('description')}" th:text="${err}"></li>
                </ul>
                <div class="form-group">
                    <label>Input</label>
                    <textarea class="form-control" placeholder="Input" rows="5" th:field="*{inputDescription}"></textarea>
                </div>
                <ul class="text-danger" th:if="${#fields.hasErrors('inputDescription')}" >
                    <li  th:each="err: ${#fields.errors('inputDescription')}" th:text="${err}"></li>
                </ul>
                <div class="form-group">
                    <label>Output</label>
                    <textarea class="form-control" placeholder="Output" rows="5" th:field="*{outputDescription}"></textarea>
                </div>
                <ul class="text-danger" th:if="${#fields.hasErrors('outputDescription')}" >
                    <li  th:each="err: ${#fields.errors('outputDescription')}" th:text="${err}"></li>
                </ul>
                <div class="form-group">
                    <label>Notes</label>
                    <textarea class="form-control" placeholder="Notes" rows="5" th:field="*{notes}"></textarea>
                </div>
                <ul class="text-danger" th:if="${#fields.hasErrors('notes')}" >
                    <li  th:each="err: ${#fields.errors('notes')}" th:text="${err}"></li>
                </ul>
                <div class="form-group">
                    <label>Tutorial</label>
                    <textarea class="form-control" placeholder="Tutorial" th:field="*{tutorial}"></textarea>
                </div>
                <ul class="text-danger" th:if="${#fields.hasErrors('tutorial')}" >
                    <li  th:each="err: ${#fields.errors('tutorial')}" th:text="${err}"></li>
                </ul>
                <div class="form-group">
                    <label>Input/Output Files</label>
                    <div class="custom-file">
                        <input type="file" class="custom-file-input" id="customFile" name="ioFiles" multiple>
                        <label class="custom-file-label" for="customFile">Input/Output Files</label>
                    </div>
                    <ul class="text-danger" th:if="${ioFilesProblems}" >
                        <li  th:each="err: ${ioFilesProblems}" th:text="${err}"></li>
                    </ul>
                    <ul>
                        <li><small class="form-text text-muted">Input files must end with ".in"</small></li>
                        <li><small class="form-text text-muted">Output files must end with ".out"</small></li>
                        <li> <small class="form-text text-muted">Each two I/O files that represents the same test must have same name</small></li>
                        <li><small class="form-text text-muted">Sample files must be prefixed with "sample" and follow all the conditions above</small></li>
                        <li><small class="form-text text-muted">Must exists at least one sample and one main test files</small></li>
                    </ul>
                </div>
                <div class="text-right form-group">
                    <button type="submit" class="btn-round btn btn-primary">Submit</button>
                </div>
            </form>
        </div>
        <div class="col-md-4 col-xs-4">
            fsdafdfdgfnbfdsd
        </div>
    </div>


    <footer th:replace="fragments/footer :: footer">...</footer>
</div>

<script th:src="@{../../js/jquery-3.4.1.min.js}"></script>
<script th:src="@{../../js/popper.min.js}"></script>
<script th:src="@{../../js/bootstrap.min.js}"></script>
<script>
$(".custom-file-input").on("change", function() {
  const fi = document.getElementById('customFile');
  if(fi.files.length < 4) {
    $('#customFile').val('');
    alert("Please select at least 4 files");
  }
    else if (fi.files.length > 0) {
        for (const i = 0; i <= fi.files.length - 1; i++) {
            const fsize = fi.files.item(i).size;
            const file = Math.round((fsize / 1024));
            // The size of the file.
            if (file >= 2048) {
                $('#customFile').val('');
                alert("Please select an image less than 2mb");
            } else {
                $(this).siblings(".custom-file-label").addClass("selected").html(fi.files.length + " files selected");
            }
        }
    }
});
</script>
</body>

</html>